let search=document.getElementById("search"),result=document.getElementById("result"),poster=document.getElementById("poster"),description=document.getElementById("description"),recentSearch=document.getElementById("recent-search"),information=document.getElementById("information");search.oninput=function(){let e=this.value;result.innerHTML="",e.length>1&&fetch(`https://api.anilibria.tv/v2/searchTitles?search=${e}&filter=id,names.ru,posters.original.url,description&limit=10`).then((function(e){return e.json()})).then((function(e){let t="";var a="";let r=0;if(0!=e.length){if(JSON.parse(localStorage.getItem("searchStory"))){let e=JSON.parse(localStorage.getItem("searchStory")),t=0;for(e.length-1<=4?(t=0,r=e.length):(t=e.length-5,r=e.length),i=e.length-1;i>=t;i--)a+='<li class="search__li" id = "'+JSON.parse(localStorage.getItem(e[i])).id+'"><a class="search__link2" data-id= "'+JSON.parse(localStorage.getItem(e[i])).id+'" href="#"><img class="search__image" src=https://www.anilibria.tv'+JSON.parse(localStorage.getItem(e[i])).posters.original.url+' alt="постер" />'+JSON.parse(localStorage.getItem(e[i])).names.ru+"</a></li>"}let l=0;for(l=e.length+r>10?10-r:e.length,i=0;i<l;i++)t+='<li class="search__li" id = "'+e[i].id+'"><a class="search__link" data-id= "'+e[i].id+'" href="#"><img class="search__image" src=https://www.anilibria.tv'+e[i].posters.original.url+' alt="постер" />'+e[i].names.ru+"</a></li>";result.innerHTML='<ul class="search__ul">'+a+t+"</ul>"}else result.innerHTML='<ul class="search__ul"><li class="search__li">Сожалеем, но ничего не найдено</li></ul>'})).catch((function(e){console.warn("Что-то пошло не так.",e)}))},result.onclick=function(e){let t=e.target.dataset.id;null!=e.target.dataset.id&&(information.style.display="block",fetch(`https://api.anilibria.tv/v2/getTitle?id=${t}&filter=id,names.ru,posters.original.url,description`).then((function(e){return e.json()})).then((function(e){let t=JSON.parse(localStorage.getItem("searchStory"));t||(t=[]),t.push(e.id),localStorage.setItem("searchStory",JSON.stringify(t)),localStorage.setItem(e.id,JSON.stringify(e));let a=JSON.parse(localStorage.getItem(e.id));poster.innerHTML='<img class="product-card__image" id ="poster" src="https://www.anilibria.tv'+a.posters.original.url+'" alt="Постер" />',description.innerHTML='<h4 class="heading heading_level-4">'+a.names.ru+"<br>"+a.description+"</h4>";let r="",l=JSON.parse(localStorage.getItem("searchStory")),s=0;for(s=l.length-1<=2?0:l.length-3,i=l.length-1;i>=s;i--)r+='<a class="product-card product-card__pc3" href="#"><div class="product-card__image-container2"><img class="product-card__image product-card__image2" src="https://www.anilibria.tv'+JSON.parse(localStorage.getItem(l[i])).posters.original.url+'" alt="Постер" /></div><h4 class="heading heading_level-5">'+JSON.parse(localStorage.getItem(l[i])).names.ru+"</h4></a>";recentSearch.innerHTML=r})).catch((function(e){console.warn("Что-то пошло не так.",e)})))},document.addEventListener("click",(function(e){"search"!=e.target.id?result.style.display="none":result.style.display="block"}));
//# sourceMappingURL=index.ffab32ec.js.map

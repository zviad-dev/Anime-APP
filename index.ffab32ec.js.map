{"mappings":"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","sources":["js/suggest.js"],"sourcesContent":["let search = document.getElementById(\"search\");\r\nlet result = document.getElementById(\"result\");\r\nlet poster = document.getElementById(\"poster\");\r\nlet description = document.getElementById(\"description\");\r\nlet recentSearch = document.getElementById(\"recent-search\");\r\nlet information = document.getElementById(\"information\");\r\n\r\nsearch.oninput = function() {\r\n  let anime = this.value;\r\n  result.innerHTML = '';\r\n  if (anime.length > 1){ //ограничение API\r\n    fetch(`https://api.anilibria.tv/v2/searchTitles?search=${anime}&filter=id,names.ru,posters.original.url,description&limit=10`)\r\n      .then(function(response) {return response.json();})\r\n      .then(function(data) {\r\n        let list = \"\";\r\n        var suggest = '';\r\n        let temp3 = 0;\r\n        if (data.length != 0) {\r\n        if (JSON.parse(localStorage.getItem(\"searchStory\"))) {\r\n        let temp = JSON.parse(localStorage.getItem(\"searchStory\"));\r\n        let temp2 = 0;\r\n        if (temp.length - 1 <= 4) {\r\n          temp2 = 0;\r\n          temp3 = temp.length;\r\n        } else {\r\n          temp2 = temp.length - 5;\r\n          temp3 = temp.length;\r\n        }\r\n        for(i=temp.length - 1; i>=temp2; i--) { \r\n          suggest += '<li class=\"search__li\" id = \"'+ JSON.parse(localStorage.getItem(temp[i])).id + '\"><a class=\"search__link2\" data-id= \"'+ JSON.parse(localStorage.getItem(temp[i])).id + '\" href=\"#\">' + '<img class=\"search__image\" src=https://www.anilibria.tv' + JSON.parse(localStorage.getItem(temp[i])).posters.original.url + ' alt=\"постер\" />' + JSON.parse(localStorage.getItem(temp[i])).names.ru + '</a></li>';\r\n        }\r\n        }        \r\n        let temp4 = 0; \r\n        if (data.length + temp3 > 10) {\r\n          temp4 = 10 - temp3;\r\n        } else {\r\n          temp4 = data.length;\r\n        }\r\n        for (i=0; i<temp4; i++) {\r\n          list += '<li class=\"search__li\" id = \"'+ data[i].id + '\"><a class=\"search__link\" data-id= \"'+ data[i].id + '\" href=\"#\">' + '<img class=\"search__image\" src=https://www.anilibria.tv' + data[i].posters.original.url + ' alt=\"постер\" />' + data[i].names.ru + '</a></li>';\r\n        }\r\n        result.innerHTML = '<ul class=\"search__ul\">' + suggest + list + '</ul>';\r\n        } \r\n        else {\r\n          result.innerHTML = '<ul class=\"search__ul\"><li class=\"search__li\">' + 'Сожалеем, но ничего не найдено' + '</li></ul>';\r\n        }\r\n      }).catch(function (err) {\r\n      console.warn('Что-то пошло не так.', err);\r\n      })\r\n  }\r\n} \r\n\r\nresult.onclick = function(data) {\r\n  let choice = data.target.dataset.id; \r\n  if (data.target.dataset.id != undefined) {\r\n    information.style.display = 'block';\r\n    fetch(`https://api.anilibria.tv/v2/getTitle?id=${choice}&filter=id,names.ru,posters.original.url,description`)\r\n      .then(function(response) {return response.json();})\r\n      .then(function(data) {      \r\n        let searches = JSON.parse(localStorage.getItem(\"searchStory\")); \r\n        if  (!searches) {\r\n          searches = []\r\n        }\r\n        searches.push(data.id);\r\n        localStorage.setItem(\"searchStory\", JSON.stringify(searches)); \r\n        localStorage.setItem(data.id, JSON.stringify(data));          \r\n        let info = JSON.parse(localStorage.getItem(data.id));  \r\n        poster.innerHTML = '<img class=\"product-card__image\" id =\"poster\" src=\"https://www.anilibria.tv' + info.posters.original.url + '\" alt=\"Постер\" />';\r\n        description.innerHTML = '<h4 class=\"heading heading_level-4\">' + info.names.ru + '<br>' + info.description + '</h4>';\r\n        let listRecentSearch = \"\";\r\n        let keys = []; \r\n        let temp = JSON.parse(localStorage.getItem(\"searchStory\"));\r\n        let temp2 = 0;\r\n        if (temp.length - 1 <= 2) {\r\n          temp2 = 0;\r\n        } else {\r\n          temp2 = temp.length - 3;\r\n        }\r\n        for(i=temp.length - 1; i>=temp2; i--) { \r\n          // keys.push(temp[i]);\r\n          listRecentSearch += '<a class=\"product-card product-card__pc3\" href=\"#\"><div class=\"product-card__image-container2\"><img class=\"product-card__image product-card__image2\" src=\"https://www.anilibria.tv' + JSON.parse(localStorage.getItem(temp[i])).posters.original.url + '\" alt=\"Постер\" /></div><h4 class=\"heading heading_level-5\">' + JSON.parse(localStorage.getItem(temp[i])).names.ru + '</h4></a>';\r\n        }\r\n        recentSearch.innerHTML = listRecentSearch;\r\n    }).catch(function (err) {\r\n    console.warn('Что-то пошло не так.', err);\r\n    })\r\n  }\r\n}\r\n\r\ndocument.addEventListener('click', function(e) {\r\n  if (e.target.id != 'search') {\r\n    result.style.display = 'none';\r\n  }\r\n   else {\r\n    result.style.display = 'block';\r\n  }});"],"names":["search","document","getElementById","result","poster","description","recentSearch","information","oninput","anime","this","value","innerHTML","length","fetch","then","response","json","data","list","suggest","temp3","JSON","parse","localStorage","getItem","temp","temp2","i","id","posters","original","url","names","ru","temp4","catch","err","console","warn","onclick","data1","choice","target","dataset","undefined","style","display","searches","push","setItem","stringify","info","listRecentSearch","addEventListener","e"],"version":3,"file":"index.ffab32ec.js.map"}